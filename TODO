Optimization: use MSVCRT.DLL DwordToStr instead of hand-written ones
Optimization: use MSVCRT.DLL strcpy and strcat functions instead of KERNEL32 ones?

Profiler:

    #include <stdlib.h>
    #include <stdio.h>
    #include <string.h>static INT64 PerformanceCounter()
    {
        LARGE_INTEGER li;
        QueryPerformanceCounter(&li);
        return li.QuadPart;
    }

    static INT64 PerformanceFrequency()
    {
        LARGE_INTEGER li;
        QueryPerformanceFrequency(&li);
        return li.QuadPart;
    }

    INT64 start = PerformanceCounter();
    INT64 finish = PerformanceCounter();
    double elapsedMilliseconds = ((finish - start) * 1000.0) / PerformanceFrequency();
    CHAR s[128];
    sprintf(s, "%f", elapsedMilliseconds);
    MessageBoxA(0, s, 0, 0);